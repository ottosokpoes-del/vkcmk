# Enhanced Security Environment Configuration
# Copy this file to .env and update with your actual values

# Server Configuration
NODE_ENV=production
PORT=3000
HOST=0.0.0.0

# Database Configuration (MySQL/MariaDB)
DB_HOST=localhost
DB_PORT=3306
DB_NAME=grader_marketplace
DB_USER=grader_user
DB_PASSWORD=your_secure_password_here
DB_CHARSET=utf8mb4
DB_TIMEZONE=+00:00

# Security Configuration
JWT_SECRET=your_super_secure_jwt_secret_key_minimum_64_characters_long
JWT_EXPIRES_IN=7d
JWT_REFRESH_EXPIRES_IN=30d

# Session Security
SESSION_SECRET=your_session_secret_key_minimum_64_characters_long
COOKIE_SECRET=your_cookie_secret_key_minimum_64_characters_long

# Password Security
BCRYPT_ROUNDS=12
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SYMBOLS=true

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=1000
RATE_LIMIT_AUTH_MAX=10
RATE_LIMIT_STRICT_MAX=5

# CORS Configuration
FRONTEND_URL=https://yourdomain.com
ALLOWED_ORIGINS=https://yourdomain.com,https://www.yourdomain.com
CORS_CREDENTIALS=true

# File Upload Security
MAX_FILE_SIZE_MB=10
MAX_IMAGE_SIZE_MB=5
ALLOWED_FILE_TYPES=jpg,jpeg,png,gif,webp,pdf,doc,docx
UPLOAD_PATH=./uploads
SCAN_UPLOADS=true

# Email Configuration (for notifications)
SMTP_HOST=smtp.your-provider.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your_email@domain.com
SMTP_PASS=your_email_password
FROM_EMAIL=noreply@yourdomain.com
FROM_NAME=Grader Marketplace

# Two-Factor Authentication
TWO_FACTOR_ISSUER=Grader Marketplace
TWO_FACTOR_WINDOW=2

# Security Monitoring
LOG_SECURITY_EVENTS=true
LOG_FAILED_LOGINS=true
LOG_SUSPICIOUS_ACTIVITY=true
SECURITY_LOG_LEVEL=medium

# Backup Configuration
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_PATH=./backups

# SSL/TLS Configuration
SSL_CERT_PATH=/path/to/cert.pem
SSL_KEY_PATH=/path/to/key.pem
FORCE_HTTPS=true

# Redis Configuration (for session storage and caching)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password
REDIS_DB=0

# Monitoring and Logging
LOG_LEVEL=info
LOG_FILE=./logs/app.log
LOG_MAX_SIZE=10m
LOG_MAX_FILES=5

# API Security
API_VERSION=v1
API_RATE_LIMIT_PER_MINUTE=60
API_TIMEOUT_MS=30000

# Content Security Policy
CSP_REPORT_URI=https://yourdomain.com/csp-report
CSP_REPORT_ONLY=false

# Database Security
DB_SSL_ENABLED=true
DB_SSL_REJECT_UNAUTHORIZED=true
DB_CONNECTION_LIMIT=10
DB_ACQUIRE_TIMEOUT=60000
DB_TIMEOUT=60000

# Application Security
TRUST_PROXY=true
HELMET_ENABLED=true
COMPRESSION_ENABLED=true
XSS_PROTECTION=true
CSRF_PROTECTION=true

# Development vs Production
DEBUG=false
VERBOSE_LOGGING=false
ENABLE_SWAGGER=false
ENABLE_METRICS=true

# External Services
GOOGLE_RECAPTCHA_SECRET=your_recaptcha_secret
GOOGLE_RECAPTCHA_SITE_KEY=your_recaptcha_site_key

# Backup and Recovery
BACKUP_ENCRYPTION_KEY=your_backup_encryption_key
BACKUP_COMPRESSION=true

# Performance and Security
CLUSTER_MODE=false
WORKER_PROCESSES=1
MEMORY_LIMIT=512m
REQUEST_TIMEOUT=30000

# Security Headers
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true
REFERRER_POLICY=strict-origin-when-cross-origin

# Input Validation
MAX_INPUT_LENGTH=1000
MAX_DESCRIPTION_LENGTH=5000
SANITIZE_INPUT=true
VALIDATE_FILE_TYPES=true

# Session Configuration
SESSION_MAX_AGE=86400000
SESSION_ROLLING=true
SESSION_SECURE=true
SESSION_HTTP_ONLY=true
SESSION_SAME_SITE=strict

# Cache Configuration
CACHE_TTL=3600
CACHE_MAX_SIZE=100
CACHE_ENABLED=true

# Error Handling
ERROR_REPORTING=true
ERROR_LOG_LEVEL=error
SHOW_ERROR_DETAILS=false

# Health Check
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30000
HEALTH_CHECK_TIMEOUT=5000
